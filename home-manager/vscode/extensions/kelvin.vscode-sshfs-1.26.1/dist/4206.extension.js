exports.id="4206",exports.ids=["4206"],exports.modules={3445:(e,t,n)=>{const o=t,{Buffer:i}=n(4300),s=n(2037);o.toBuffer=function(e,t,n){let o;if(n=~~n,this.isV4Format(e))o=t||i.alloc(n+4),e.split(/\./g).map((e=>{o[n++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){const s=e.split(":",8);let r;for(r=0;r<s.length;r++){let e;this.isV4Format(s[r])&&(e=this.toBuffer(s[r]),s[r]=e.slice(0,2).toString("hex")),e&&++r<8&&s.splice(r,0,e.slice(2,4).toString("hex"))}if(""===s[0])for(;s.length<8;)s.unshift("0");else if(""===s[s.length-1])for(;s.length<8;)s.push("0");else if(s.length<8){for(r=0;r<s.length&&""!==s[r];r++);const e=[r,1];for(r=9-s.length;r>0;r--)e.push("0");s.splice(...e)}for(o=t||i.alloc(n+16),r=0;r<s.length;r++){const e=parseInt(s[r],16);o[n++]=e>>8&255,o[n++]=255&e}}if(!o)throw Error(`Invalid ip address: ${e}`);return o},o.toString=function(e,t,n){t=~~t;let o=[];if(4===(n=n||e.length-t)){for(let i=0;i<n;i++)o.push(e[t+i]);o=o.join(".")}else if(16===n){for(let i=0;i<n;i+=2)o.push(e.readUInt16BE(t+i).toString(16));o=o.join(":"),o=o.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),o=o.replace(/:{3,4}/,"::")}return o};const r=/^(\d{1,3}\.){3,3}\d{1,3}$/,a=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function f(e){return 4===e?"ipv4":6===e?"ipv6":e?e.toLowerCase():"ipv4"}o.isV4Format=function(e){return r.test(e)},o.isV6Format=function(e){return a.test(e)},o.fromPrefixLen=function(e,t){let n=4;"ipv6"===(t=e>32?"ipv6":f(t))&&(n=16);const s=i.alloc(n);for(let t=0,n=s.length;t<n;++t){let n=8;e<8&&(n=e),e-=n,s[t]=255&~(255>>n)}return o.toString(s)},o.mask=function(e,t){e=o.toBuffer(e),t=o.toBuffer(t);const n=i.alloc(Math.max(e.length,t.length));let s;if(e.length===t.length)for(s=0;s<e.length;s++)n[s]=e[s]&t[s];else if(4===t.length)for(s=0;s<t.length;s++)n[s]=e[e.length-4+s]&t[s];else{for(s=0;s<n.length-6;s++)n[s]=0;for(n[10]=255,n[11]=255,s=0;s<e.length;s++)n[s+12]=e[s]&t[s+12];s+=12}for(;s<n.length;s++)n[s]=0;return o.toString(n)},o.cidr=function(e){const t=e.split("/"),n=t[0];if(2!==t.length)throw new Error(`invalid CIDR subnet: ${n}`);const i=o.fromPrefixLen(parseInt(t[1],10));return o.mask(n,i)},o.subnet=function(e,t){const n=o.toLong(o.mask(e,t)),i=o.toBuffer(t);let s=0;for(let e=0;e<i.length;e++)if(255===i[e])s+=8;else{let t=255&i[e];for(;t;)t=t<<1&255,s++}const r=2**(32-s);return{networkAddress:o.fromLong(n),firstAddress:r<=2?o.fromLong(n):o.fromLong(n+1),lastAddress:r<=2?o.fromLong(n+r-1):o.fromLong(n+r-2),broadcastAddress:o.fromLong(n+r-1),subnetMask:t,subnetMaskLength:s,numHosts:r<=2?r:r-2,length:r,contains:e=>n===o.toLong(o.mask(e,t))}},o.cidrSubnet=function(e){const t=e.split("/"),n=t[0];if(2!==t.length)throw new Error(`invalid CIDR subnet: ${n}`);const i=o.fromPrefixLen(parseInt(t[1],10));return o.subnet(n,i)},o.not=function(e){const t=o.toBuffer(e);for(let e=0;e<t.length;e++)t[e]=255^t[e];return o.toString(t)},o.or=function(e,t){if(e=o.toBuffer(e),t=o.toBuffer(t),e.length===t.length){for(let n=0;n<e.length;++n)e[n]|=t[n];return o.toString(e)}let n=e,i=t;t.length>e.length&&(n=t,i=e);const s=n.length-i.length;for(let e=s;e<n.length;++e)n[e]|=i[e-s];return o.toString(n)},o.isEqual=function(e,t){if(e=o.toBuffer(e),t=o.toBuffer(t),e.length===t.length){for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if(4===t.length){const n=t;t=e,e=n}for(let e=0;e<10;e++)if(0!==t[e])return!1;const n=t.readUInt16BE(10);if(0!==n&&65535!==n)return!1;for(let n=0;n<4;n++)if(e[n]!==t[n+12])return!1;return!0},o.isPrivate=function(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},o.isPublic=function(e){return!o.isPrivate(e)},o.isLoopback=function(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)},o.loopback=function(e){if("ipv4"!==(e=f(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},o.address=function(e,t){const n=s.networkInterfaces();if(t=f(t),e&&"private"!==e&&"public"!==e){const o=n[e].filter((e=>f(e.family)===t));if(0===o.length)return;return o[0].address}const i=Object.keys(n).map((i=>{const s=n[i].filter((n=>(n.family=f(n.family),n.family===t&&!o.isLoopback(n.address)&&(!e||("public"===e?o.isPrivate(n.address):o.isPublic(n.address))))));return s.length?s[0].address:void 0})).filter(Boolean);return i.length?i[0]:o.loopback(t)},o.toLong=function(e){let t=0;return e.split(".").forEach((e=>{t<<=8,t+=parseInt(e)})),t>>>0},o.fromLong=function(e){return`${e>>>24}.${e>>16&255}.${e>>8&255}.${255&e}`}},2875:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(9994);class i{constructor(e){if(this.length=0,this._encoding="utf8",this._writeOffset=0,this._readOffset=0,i.isSmartBufferOptions(e))if(e.encoding&&(o.checkEncoding(e.encoding),this._encoding=e.encoding),e.size){if(!(o.isFiniteInteger(e.size)&&e.size>0))throw new Error(o.ERRORS.INVALID_SMARTBUFFER_SIZE);this._buff=Buffer.allocUnsafe(e.size)}else if(e.buff){if(!Buffer.isBuffer(e.buff))throw new Error(o.ERRORS.INVALID_SMARTBUFFER_BUFFER);this._buff=e.buff,this.length=e.buff.length}else this._buff=Buffer.allocUnsafe(4096);else{if(void 0!==e)throw new Error(o.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(4096)}}static fromSize(e,t){return new this({size:e,encoding:t})}static fromBuffer(e,t){return new this({buff:e,encoding:t})}static fromOptions(e){return new this(e)}static isSmartBufferOptions(e){const t=e;return t&&(void 0!==t.encoding||void 0!==t.size||void 0!==t.buff)}readInt8(e){return this._readNumberValue(Buffer.prototype.readInt8,1,e)}readInt16BE(e){return this._readNumberValue(Buffer.prototype.readInt16BE,2,e)}readInt16LE(e){return this._readNumberValue(Buffer.prototype.readInt16LE,2,e)}readInt32BE(e){return this._readNumberValue(Buffer.prototype.readInt32BE,4,e)}readInt32LE(e){return this._readNumberValue(Buffer.prototype.readInt32LE,4,e)}readBigInt64BE(e){return o.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,e)}readBigInt64LE(e){return o.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,e)}writeInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeInt8,1,e,t),this}insertInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeInt8,1,e,t)}writeInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}insertInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}writeInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}insertInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}writeInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}insertInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}writeInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}insertInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}writeBigInt64BE(e,t){return o.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,e,t)}insertBigInt64BE(e,t){return o.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,e,t)}writeBigInt64LE(e,t){return o.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,e,t)}insertBigInt64LE(e,t){return o.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,e,t)}readUInt8(e){return this._readNumberValue(Buffer.prototype.readUInt8,1,e)}readUInt16BE(e){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,e)}readUInt16LE(e){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,e)}readUInt32BE(e){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,e)}readUInt32LE(e){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,e)}readBigUInt64BE(e){return o.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,e)}readBigUInt64LE(e){return o.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,e)}writeUInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,e,t)}insertUInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,e,t)}writeUInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}insertUInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}writeUInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}insertUInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}writeUInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}insertUInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}writeUInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}insertUInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}writeBigUInt64BE(e,t){return o.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,t)}insertBigUInt64BE(e,t){return o.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,t)}writeBigUInt64LE(e,t){return o.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,t)}insertBigUInt64LE(e,t){return o.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,t)}readFloatBE(e){return this._readNumberValue(Buffer.prototype.readFloatBE,4,e)}readFloatLE(e){return this._readNumberValue(Buffer.prototype.readFloatLE,4,e)}writeFloatBE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}insertFloatBE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}writeFloatLE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}insertFloatLE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}readDoubleBE(e){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,e)}readDoubleLE(e){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,e)}writeDoubleBE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}insertDoubleBE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}writeDoubleLE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}insertDoubleLE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}readString(e,t){let n;"number"==typeof e?(o.checkLengthValue(e),n=Math.min(e,this.length-this._readOffset)):(t=e,n=this.length-this._readOffset),void 0!==t&&o.checkEncoding(t);const i=this._buff.slice(this._readOffset,this._readOffset+n).toString(t||this._encoding);return this._readOffset+=n,i}insertString(e,t,n){return o.checkOffsetValue(t),this._handleString(e,!0,t,n)}writeString(e,t,n){return this._handleString(e,!1,t,n)}readStringNT(e){void 0!==e&&o.checkEncoding(e);let t=this.length;for(let e=this._readOffset;e<this.length;e++)if(0===this._buff[e]){t=e;break}const n=this._buff.slice(this._readOffset,t);return this._readOffset=t+1,n.toString(e||this._encoding)}insertStringNT(e,t,n){return o.checkOffsetValue(t),this.insertString(e,t,n),this.insertUInt8(0,t+e.length),this}writeStringNT(e,t,n){return this.writeString(e,t,n),this.writeUInt8(0,"number"==typeof t?t+e.length:this.writeOffset),this}readBuffer(e){void 0!==e&&o.checkLengthValue(e);const t="number"==typeof e?e:this.length,n=Math.min(this.length,this._readOffset+t),i=this._buff.slice(this._readOffset,n);return this._readOffset=n,i}insertBuffer(e,t){return o.checkOffsetValue(t),this._handleBuffer(e,!0,t)}writeBuffer(e,t){return this._handleBuffer(e,!1,t)}readBufferNT(){let e=this.length;for(let t=this._readOffset;t<this.length;t++)if(0===this._buff[t]){e=t;break}const t=this._buff.slice(this._readOffset,e);return this._readOffset=e+1,t}insertBufferNT(e,t){return o.checkOffsetValue(t),this.insertBuffer(e,t),this.insertUInt8(0,t+e.length),this}writeBufferNT(e,t){return void 0!==t&&o.checkOffsetValue(t),this.writeBuffer(e,t),this.writeUInt8(0,"number"==typeof t?t+e.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(e){o.checkOffsetValue(e),o.checkTargetOffset(e,this),this._readOffset=e}get writeOffset(){return this._writeOffset}set writeOffset(e){o.checkOffsetValue(e),o.checkTargetOffset(e,this),this._writeOffset=e}get encoding(){return this._encoding}set encoding(e){o.checkEncoding(e),this._encoding=e}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(e){const t="string"==typeof e?e:this._encoding;return o.checkEncoding(t),this._buff.toString(t,0,this.length)}destroy(){return this.clear(),this}_handleString(e,t,n,i){let s=this._writeOffset,r=this._encoding;"number"==typeof n?s=n:"string"==typeof n&&(o.checkEncoding(n),r=n),"string"==typeof i&&(o.checkEncoding(i),r=i);const a=Buffer.byteLength(e,r);return t?this.ensureInsertable(a,s):this._ensureWriteable(a,s),this._buff.write(e,s,a,r),t?this._writeOffset+=a:"number"==typeof n?this._writeOffset=Math.max(this._writeOffset,s+a):this._writeOffset+=a,this}_handleBuffer(e,t,n){const o="number"==typeof n?n:this._writeOffset;return t?this.ensureInsertable(e.length,o):this._ensureWriteable(e.length,o),e.copy(this._buff,o),t?this._writeOffset+=e.length:"number"==typeof n?this._writeOffset=Math.max(this._writeOffset,o+e.length):this._writeOffset+=e.length,this}ensureReadable(e,t){let n=this._readOffset;if(void 0!==t&&(o.checkOffsetValue(t),n=t),n<0||n+e>this.length)throw new Error(o.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(e,t){o.checkOffsetValue(t),this._ensureCapacity(this.length+e),t<this.length&&this._buff.copy(this._buff,t+e,t,this._buff.length),t+e>this.length?this.length=t+e:this.length+=e}_ensureWriteable(e,t){const n="number"==typeof t?t:this._writeOffset;this._ensureCapacity(n+e),n+e>this.length&&(this.length=n+e)}_ensureCapacity(e){const t=this._buff.length;if(e>t){let n=this._buff,o=3*t/2+1;o<e&&(o=e),this._buff=Buffer.allocUnsafe(o),n.copy(this._buff,0,0,t)}}_readNumberValue(e,t,n){this.ensureReadable(t,n);const o=e.call(this._buff,"number"==typeof n?n:this._readOffset);return void 0===n&&(this._readOffset+=t),o}_insertNumberValue(e,t,n,i){return o.checkOffsetValue(i),this.ensureInsertable(t,i),e.call(this._buff,n,i),this._writeOffset+=t,this}_writeNumberValue(e,t,n,i){if("number"==typeof i){if(i<0)throw new Error(o.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);o.checkOffsetValue(i)}const s="number"==typeof i?i:this._writeOffset;return this._ensureWriteable(t,s),e.call(this._buff,n,s),"number"==typeof i?this._writeOffset=Math.max(this._writeOffset,s+t):this._writeOffset+=t,this}}t.SmartBuffer=i},9994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(4300),i={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};function s(e){return"number"==typeof e&&isFinite(e)&&function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}(e)}function r(e,t){if("number"!=typeof e)throw new Error(t?i.INVALID_OFFSET_NON_NUMBER:i.INVALID_LENGTH_NON_NUMBER);if(!s(e)||e<0)throw new Error(t?i.INVALID_OFFSET:i.INVALID_LENGTH)}t.ERRORS=i,t.checkEncoding=function(e){if(!o.Buffer.isEncoding(e))throw new Error(i.INVALID_ENCODING)},t.isFiniteInteger=s,t.checkLengthValue=function(e){r(e,!1)},t.checkOffsetValue=function(e){r(e,!0)},t.checkTargetOffset=function(e,t){if(e<0||e>t.length)throw new Error(i.INVALID_TARGET_OFFSET)},t.bigIntAndBufferInt64Check=function(e){if("undefined"==typeof BigInt)throw new Error("Platform does not support JS BigInt type.");if(void 0===o.Buffer.prototype[e])throw new Error(`Platform does not support Buffer.prototype.${e}.`)}},7117:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{f(o.next(e))}catch(e){s(e)}}function a(e){try{f(o.throw(e))}catch(e){s(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}f((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SocksClientError=t.SocksClient=void 0;const i=n(2361),s=n(1808),r=n(3445),a=n(2875),f=n(9556),c=n(1251),h=n(5494),u=n(597);Object.defineProperty(t,"SocksClientError",{enumerable:!0,get:function(){return u.SocksClientError}});class d extends i.EventEmitter{constructor(e){super(),this.options=Object.assign({},e),(0,c.validateSocksClientOptions)(e),this.setState(f.SocksClientState.Created)}static createConnection(e,t){return new Promise(((n,o)=>{try{(0,c.validateSocksClientOptions)(e,["connect"])}catch(e){return"function"==typeof t?(t(e),n(e)):o(e)}const i=new d(e);i.connect(e.existing_socket),i.once("established",(e=>{i.removeAllListeners(),"function"==typeof t?(t(null,e),n(e)):n(e)})),i.once("error",(e=>{i.removeAllListeners(),"function"==typeof t?(t(e),n(e)):o(e)}))}))}static createConnectionChain(e,t){return new Promise(((n,i)=>o(this,void 0,void 0,(function*(){try{(0,c.validateSocksClientChainOptions)(e)}catch(e){return"function"==typeof t?(t(e),n(e)):i(e)}e.randomizeChain&&(0,u.shuffleArray)(e.proxies);try{let o;for(let t=0;t<e.proxies.length;t++){const n=e.proxies[t],i=t===e.proxies.length-1?e.destination:{host:e.proxies[t+1].host||e.proxies[t+1].ipaddress,port:e.proxies[t+1].port},s=yield d.createConnection({command:"connect",proxy:n,destination:i,existing_socket:o});o=o||s.socket}"function"==typeof t?(t(null,{socket:o}),n({socket:o})):n({socket:o})}catch(e){"function"==typeof t?(t(e),n(e)):i(e)}}))))}static createUDPFrame(e){const t=new a.SmartBuffer;return t.writeUInt16BE(0),t.writeUInt8(e.frameNumber||0),s.isIPv4(e.remoteHost.host)?(t.writeUInt8(f.Socks5HostType.IPv4),t.writeUInt32BE(r.toLong(e.remoteHost.host))):s.isIPv6(e.remoteHost.host)?(t.writeUInt8(f.Socks5HostType.IPv6),t.writeBuffer(r.toBuffer(e.remoteHost.host))):(t.writeUInt8(f.Socks5HostType.Hostname),t.writeUInt8(Buffer.byteLength(e.remoteHost.host)),t.writeString(e.remoteHost.host)),t.writeUInt16BE(e.remoteHost.port),t.writeBuffer(e.data),t.toBuffer()}static parseUDPFrame(e){const t=a.SmartBuffer.fromBuffer(e);t.readOffset=2;const n=t.readUInt8(),o=t.readUInt8();let i;return i=o===f.Socks5HostType.IPv4?r.fromLong(t.readUInt32BE()):o===f.Socks5HostType.IPv6?r.toString(t.readBuffer(16)):t.readString(t.readUInt8()),{frameNumber:n,remoteHost:{host:i,port:t.readUInt16BE()},data:t.readBuffer()}}setState(e){this.state!==f.SocksClientState.Error&&(this.state=e)}connect(e){this.onDataReceived=e=>this.onDataReceivedHandler(e),this.onClose=()=>this.onCloseHandler(),this.onError=e=>this.onErrorHandler(e),this.onConnect=()=>this.onConnectHandler();const t=setTimeout((()=>this.onEstablishedTimeout()),this.options.timeout||f.DEFAULT_TIMEOUT);t.unref&&"function"==typeof t.unref&&t.unref(),this.socket=e||new s.Socket,this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(f.SocksClientState.Connecting),this.receiveBuffer=new h.ReceiveBuffer,e?this.socket.emit("connect"):(this.socket.connect(this.getSocketOptions()),void 0!==this.options.set_tcp_nodelay&&null!==this.options.set_tcp_nodelay&&this.socket.setNoDelay(!!this.options.set_tcp_nodelay)),this.prependOnceListener("established",(e=>{setImmediate((()=>{if(this.receiveBuffer.length>0){const t=this.receiveBuffer.get(this.receiveBuffer.length);e.socket.emit("data",t)}e.socket.resume()}))}))}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){this.state!==f.SocksClientState.Established&&this.state!==f.SocksClientState.BoundWaitingForConnection&&this.closeSocket(f.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){this.setState(f.SocksClientState.Connected),4===this.options.proxy.type?this.sendSocks4InitialHandshake():this.sendSocks5InitialHandshake(),this.setState(f.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(e){this.receiveBuffer.append(e),this.processData()}processData(){for(;this.state!==f.SocksClientState.Established&&this.state!==f.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize;)if(this.state===f.SocksClientState.SentInitialHandshake)4===this.options.proxy.type?this.handleSocks4FinalHandshakeResponse():this.handleInitialSocks5HandshakeResponse();else if(this.state===f.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===f.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else{if(this.state!==f.SocksClientState.BoundWaitingForConnection){this.closeSocket(f.ERRORS.InternalError);break}4===this.options.proxy.type?this.handleSocks4IncomingConnectionResponse():this.handleSocks5IncomingConnectionResponse()}}onCloseHandler(){this.closeSocket(f.ERRORS.SocketClosed)}onErrorHandler(e){this.closeSocket(e.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(e){this.state!==f.SocksClientState.Error&&(this.setState(f.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new u.SocksClientError(e,this.options)))}sendSocks4InitialHandshake(){const e=this.options.proxy.userId||"",t=new a.SmartBuffer;t.writeUInt8(4),t.writeUInt8(f.SocksCommand[this.options.command]),t.writeUInt16BE(this.options.destination.port),s.isIPv4(this.options.destination.host)?(t.writeBuffer(r.toBuffer(this.options.destination.host)),t.writeStringNT(e)):(t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(1),t.writeStringNT(e),t.writeStringNT(this.options.destination.host)),this.nextRequiredPacketBufferSize=f.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(t.toBuffer())}handleSocks4FinalHandshakeResponse(){const e=this.receiveBuffer.get(8);if(e[1]!==f.Socks4Response.Granted)this.closeSocket(`${f.ERRORS.Socks4ProxyRejectedConnection} - (${f.Socks4Response[e[1]]})`);else if(f.SocksCommand[this.options.command]===f.SocksCommand.bind){const t=a.SmartBuffer.fromBuffer(e);t.readOffset=2;const n={port:t.readUInt16BE(),host:r.fromLong(t.readUInt32BE())};"0.0.0.0"===n.host&&(n.host=this.options.proxy.ipaddress),this.setState(f.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:n,socket:this.socket})}else this.setState(f.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){const e=this.receiveBuffer.get(8);if(e[1]!==f.Socks4Response.Granted)this.closeSocket(`${f.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${f.Socks4Response[e[1]]})`);else{const t=a.SmartBuffer.fromBuffer(e);t.readOffset=2;const n={port:t.readUInt16BE(),host:r.fromLong(t.readUInt32BE())};this.setState(f.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket})}}sendSocks5InitialHandshake(){const e=new a.SmartBuffer,t=[f.Socks5Auth.NoAuth];(this.options.proxy.userId||this.options.proxy.password)&&t.push(f.Socks5Auth.UserPass),void 0!==this.options.proxy.custom_auth_method&&t.push(this.options.proxy.custom_auth_method),e.writeUInt8(5),e.writeUInt8(t.length);for(const n of t)e.writeUInt8(n);this.nextRequiredPacketBufferSize=f.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(e.toBuffer()),this.setState(f.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){const e=this.receiveBuffer.get(2);5!==e[0]?this.closeSocket(f.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion):e[1]===f.SOCKS5_NO_ACCEPTABLE_AUTH?this.closeSocket(f.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType):e[1]===f.Socks5Auth.NoAuth?(this.socks5ChosenAuthType=f.Socks5Auth.NoAuth,this.sendSocks5CommandRequest()):e[1]===f.Socks5Auth.UserPass?(this.socks5ChosenAuthType=f.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication()):e[1]===this.options.proxy.custom_auth_method?(this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication()):this.closeSocket(f.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){const e=this.options.proxy.userId||"",t=this.options.proxy.password||"",n=new a.SmartBuffer;n.writeUInt8(1),n.writeUInt8(Buffer.byteLength(e)),n.writeString(e),n.writeUInt8(Buffer.byteLength(t)),n.writeString(t),this.nextRequiredPacketBufferSize=f.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(n.toBuffer()),this.setState(f.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return o(this,void 0,void 0,(function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(f.SocksClientState.SentAuthentication)}))}handleSocks5CustomAuthHandshakeResponse(e){return o(this,void 0,void 0,(function*(){return yield this.options.proxy.custom_auth_response_handler(e)}))}handleSocks5AuthenticationNoAuthHandshakeResponse(e){return o(this,void 0,void 0,(function*(){return 0===e[1]}))}handleSocks5AuthenticationUserPassHandshakeResponse(e){return o(this,void 0,void 0,(function*(){return 0===e[1]}))}handleInitialSocks5AuthenticationHandshakeResponse(){return o(this,void 0,void 0,(function*(){this.setState(f.SocksClientState.ReceivedAuthenticationResponse);let e=!1;this.socks5ChosenAuthType===f.Socks5Auth.NoAuth?e=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===f.Socks5Auth.UserPass?e=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===this.options.proxy.custom_auth_method&&(e=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size))),e?this.sendSocks5CommandRequest():this.closeSocket(f.ERRORS.Socks5AuthenticationFailed)}))}sendSocks5CommandRequest(){const e=new a.SmartBuffer;e.writeUInt8(5),e.writeUInt8(f.SocksCommand[this.options.command]),e.writeUInt8(0),s.isIPv4(this.options.destination.host)?(e.writeUInt8(f.Socks5HostType.IPv4),e.writeBuffer(r.toBuffer(this.options.destination.host))):s.isIPv6(this.options.destination.host)?(e.writeUInt8(f.Socks5HostType.IPv6),e.writeBuffer(r.toBuffer(this.options.destination.host))):(e.writeUInt8(f.Socks5HostType.Hostname),e.writeUInt8(this.options.destination.host.length),e.writeString(this.options.destination.host)),e.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(e.toBuffer()),this.setState(f.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){const e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==f.Socks5Response.Granted)this.closeSocket(`${f.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${f.Socks5Response[e[1]]}`);else{const t=e[3];let n,o;if(t===f.Socks5HostType.IPv4){const e=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);o=a.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:r.fromLong(o.readUInt32BE()),port:o.readUInt16BE()},"0.0.0.0"===n.host&&(n.host=this.options.proxy.ipaddress)}else if(t===f.Socks5HostType.Hostname){const t=e[4],i=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(t);if(this.receiveBuffer.length<i)return void(this.nextRequiredPacketBufferSize=i);o=a.SmartBuffer.fromBuffer(this.receiveBuffer.get(i).slice(5)),n={host:o.readString(t),port:o.readUInt16BE()}}else if(t===f.Socks5HostType.IPv6){const e=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);o=a.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:r.toString(o.readBuffer(16)),port:o.readUInt16BE()}}this.setState(f.SocksClientState.ReceivedFinalResponse),f.SocksCommand[this.options.command]===f.SocksCommand.connect?(this.setState(f.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket})):f.SocksCommand[this.options.command]===f.SocksCommand.bind?(this.setState(f.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:n,socket:this.socket})):f.SocksCommand[this.options.command]===f.SocksCommand.associate&&(this.setState(f.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket}))}}handleSocks5IncomingConnectionResponse(){const e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==f.Socks5Response.Granted)this.closeSocket(`${f.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${f.Socks5Response[e[1]]}`);else{const t=e[3];let n,o;if(t===f.Socks5HostType.IPv4){const e=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);o=a.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:r.fromLong(o.readUInt32BE()),port:o.readUInt16BE()},"0.0.0.0"===n.host&&(n.host=this.options.proxy.ipaddress)}else if(t===f.Socks5HostType.Hostname){const t=e[4],i=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(t);if(this.receiveBuffer.length<i)return void(this.nextRequiredPacketBufferSize=i);o=a.SmartBuffer.fromBuffer(this.receiveBuffer.get(i).slice(5)),n={host:o.readString(t),port:o.readUInt16BE()}}else if(t===f.Socks5HostType.IPv6){const e=f.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);o=a.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:r.toString(o.readBuffer(16)),port:o.readUInt16BE()}}this.setState(f.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}}t.SocksClient=d},9556:(e,t)=>{"use strict";var n,o,i,s,r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.SOCKS5_NO_ACCEPTABLE_AUTH=t.SOCKS5_CUSTOM_AUTH_END=t.SOCKS5_CUSTOM_AUTH_START=t.SOCKS_INCOMING_PACKET_SIZES=t.SocksClientState=t.Socks5Response=t.Socks5HostType=t.Socks5Auth=t.Socks4Response=t.SocksCommand=t.ERRORS=t.DEFAULT_TIMEOUT=void 0,t.DEFAULT_TIMEOUT=3e4,t.ERRORS={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"},t.SOCKS_INCOMING_PACKET_SIZES={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:e=>e+7,Socks4Response:8},function(e){e[e.connect=1]="connect",e[e.bind=2]="bind",e[e.associate=3]="associate"}(n||(n={})),t.SocksCommand=n,function(e){e[e.Granted=90]="Granted",e[e.Failed=91]="Failed",e[e.Rejected=92]="Rejected",e[e.RejectedIdent=93]="RejectedIdent"}(o||(o={})),t.Socks4Response=o,function(e){e[e.NoAuth=0]="NoAuth",e[e.GSSApi=1]="GSSApi",e[e.UserPass=2]="UserPass"}(i||(i={})),t.Socks5Auth=i,t.SOCKS5_CUSTOM_AUTH_START=128,t.SOCKS5_CUSTOM_AUTH_END=254,t.SOCKS5_NO_ACCEPTABLE_AUTH=255,function(e){e[e.Granted=0]="Granted",e[e.Failure=1]="Failure",e[e.NotAllowed=2]="NotAllowed",e[e.NetworkUnreachable=3]="NetworkUnreachable",e[e.HostUnreachable=4]="HostUnreachable",e[e.ConnectionRefused=5]="ConnectionRefused",e[e.TTLExpired=6]="TTLExpired",e[e.CommandNotSupported=7]="CommandNotSupported",e[e.AddressNotSupported=8]="AddressNotSupported"}(s||(s={})),t.Socks5Response=s,function(e){e[e.IPv4=1]="IPv4",e[e.Hostname=3]="Hostname",e[e.IPv6=4]="IPv6"}(r||(r={})),t.Socks5HostType=r,function(e){e[e.Created=0]="Created",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.SentInitialHandshake=3]="SentInitialHandshake",e[e.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",e[e.SentAuthentication=5]="SentAuthentication",e[e.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",e[e.SentFinalHandshake=7]="SentFinalHandshake",e[e.ReceivedFinalResponse=8]="ReceivedFinalResponse",e[e.BoundWaitingForConnection=9]="BoundWaitingForConnection",e[e.Established=10]="Established",e[e.Disconnected=11]="Disconnected",e[e.Error=99]="Error"}(a||(a={})),t.SocksClientState=a},1251:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSocksClientChainOptions=t.validateSocksClientOptions=void 0;const o=n(597),i=n(9556),s=n(2781);function r(e,t){if(void 0!==e.custom_auth_method){if(e.custom_auth_method<i.SOCKS5_CUSTOM_AUTH_START||e.custom_auth_method>i.SOCKS5_CUSTOM_AUTH_END)throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthRange,t);if(void 0===e.custom_auth_request_handler||"function"!=typeof e.custom_auth_request_handler)throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,t);if(void 0===e.custom_auth_response_size)throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,t);if(void 0===e.custom_auth_response_handler||"function"!=typeof e.custom_auth_response_handler)throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,t)}}function a(e){return e&&"string"==typeof e.host&&"number"==typeof e.port&&e.port>=0&&e.port<=65535}function f(e){return e&&("string"==typeof e.host||"string"==typeof e.ipaddress)&&"number"==typeof e.port&&e.port>=0&&e.port<=65535&&(4===e.type||5===e.type)}function c(e){return"number"==typeof e&&e>0}t.validateSocksClientOptions=function(e,t=["connect","bind","associate"]){if(!i.SocksCommand[e.command])throw new o.SocksClientError(i.ERRORS.InvalidSocksCommand,e);if(-1===t.indexOf(e.command))throw new o.SocksClientError(i.ERRORS.InvalidSocksCommandForOperation,e);if(!a(e.destination))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsDestination,e);if(!f(e.proxy))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsProxy,e);if(r(e.proxy,e),e.timeout&&!c(e.timeout))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsTimeout,e);if(e.existing_socket&&!(e.existing_socket instanceof s.Duplex))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsExistingSocket,e)},t.validateSocksClientChainOptions=function(e){if("connect"!==e.command)throw new o.SocksClientError(i.ERRORS.InvalidSocksCommandChain,e);if(!a(e.destination))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsDestination,e);if(!(e.proxies&&Array.isArray(e.proxies)&&e.proxies.length>=2))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsProxiesLength,e);if(e.proxies.forEach((t=>{if(!f(t))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsProxy,e);r(t,e)})),e.timeout&&!c(e.timeout))throw new o.SocksClientError(i.ERRORS.InvalidSocksClientOptionsTimeout,e)}},5494:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReceiveBuffer=void 0,t.ReceiveBuffer=class{constructor(e=4096){this.buffer=Buffer.allocUnsafe(e),this.offset=0,this.originalSize=e}get length(){return this.offset}append(e){if(!Buffer.isBuffer(e))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+e.length>=this.buffer.length){const t=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+e.length)),t.copy(this.buffer)}return e.copy(this.buffer,this.offset),this.offset+=e.length}peek(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,e)}get(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");const t=Buffer.allocUnsafe(e);return this.buffer.slice(0,e).copy(t),this.buffer.copyWithin(0,e,e+this.offset-e),this.offset-=e,t}}},597:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shuffleArray=t.SocksClientError=void 0;class n extends Error{constructor(e,t){super(e),this.options=t}}t.SocksClientError=n,t.shuffleArray=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}},7590:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(7117),t)},1016:(e,t,n)=>{"use strict";n.r(t),n.d(t,{http:()=>h,socks:()=>c});var o=n(9523),i=n(3685),s=n(7590),r=n(2809),a=n(2516);function f(e){if(!e.proxy)throw new Error("Missing field 'config.proxy'");if(!e.proxy.type)throw new Error("Missing field 'config.proxy.type'");if(!e.proxy.host)throw new Error("Missing field 'config.proxy.host'");if(!e.proxy.port)throw new Error("Missing field 'config.proxy.port'");e.proxy.port=(0,a.Ru)(e.proxy.port)}async function c(e){if(r.zW.info`Creating socks proxy connection for ${e.name}`,f(e),"socks4"!==e.proxy.type&&"socks5"!==e.proxy.type)throw new Error("Expected 'config.proxy.type' to be 'socks4' or 'socks5'");try{const t=await async function(e){return(0,a.Vi)((t=>o.lookup(e,t))).then((t=>(r.zW.debug`Resolved hostname "${e}" to: ${t}`,t)))}(e.proxy.host);if(!t)throw new Error(`Couldn't resolve '${e.proxy.host}'`);return r.zW.debug`\tConnecting to ${e.host}:${e.port} over ${e.proxy.type} proxy at ${t}:${e.proxy.port}`,(await s.SocksClient.createConnection({command:"connect",destination:{host:e.host,port:e.port},proxy:{ipaddress:t,port:e.proxy.port,type:"socks4"===e.proxy.type?4:5}})).socket}catch(e){throw new Error(`Error while connecting to the the proxy: ${e.message}`)}}function h(e){return r.zW.info`Creating http proxy connection for ${e.name}`,f(e),new Promise(((t,n)=>{"http"!==e.proxy.type&&n(new Error("Expected config.proxy.type' to be 'http'"));try{r.zW.debug`\tConnecting to ${e.host}:${e.port} over http proxy at ${e.proxy.host}:${e.proxy.port}`;const n=(0,i.request)({port:e.proxy.port,hostname:e.proxy.host,method:"CONNECT",path:`${e.host}:${e.port}`});n.end(),n.on("connect",((e,n)=>{t(n)}))}catch(e){n(new Error(`Error while connecting to the the proxy: ${e.message}`))}}))}}};
//# sourceMappingURL=4206.extension.js.map