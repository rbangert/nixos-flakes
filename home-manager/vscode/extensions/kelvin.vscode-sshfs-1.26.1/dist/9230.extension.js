exports.id="9230",exports.ids=["9230"],exports.modules={2118:(t,e,n)=>{var r=n(3837),o=n(1017),i=n(2081).spawn,s="HKLM",u="HKCU",c="HKCR",a="HKCC",f=[s,u,c,"HKU",a],h="REG_SZ",p="REG_MULTI_SZ",l="REG_EXPAND_SZ",_="REG_DWORD",d="REG_QWORD",E="REG_BINARY",v="REG_NONE",y=[h,p,l,_,d,E,v],w=/(\\[a-zA-Z0-9_\s]+)*/,R=/^(HKEY_LOCAL_MACHINE|HKEY_CURRENT_USER|HKEY_CLASSES_ROOT|HKEY_USERS|HKEY_CURRENT_CONFIG)(.*)$/,m=/^(.*)\s(REG_SZ|REG_MULTI_SZ|REG_EXPAND_SZ|REG_DWORD|REG_QWORD|REG_BINARY|REG_NONE)\s+([^\s].*)$/;function g(t,e){if(!(this instanceof g))return new g(t,e);Error.captureStackTrace(this,g),this.__defineGetter__("name",(function(){return g.name})),this.__defineGetter__("message",(function(){return t})),this.__defineGetter__("code",(function(){return e}))}function G(t){var e={stdout:"",stderr:""};return t.stdout.on("data",(function(t){e.stdout+=t.toString()})),t.stderr.on("data",(function(t){e.stderr+=t.toString()})),e}function S(t,e,n){var o=n.stdout.trim(),i=n.stderr.trim();return new g(r.format("%s command exited with code %d:\n%s\n%s",t,e,o,i),e)}function D(t,e){e&&t.push("/reg:"+function(t){if("x64"==t)return"64";if("x86"==t)return"32";throw new Error("illegal architecture: "+t+" (use x86 or x64)")}(e))}function T(){return"win32"===process.platform?o.join(process.env.windir,"system32","reg.exe"):"REG"}function k(t,e,n,r,o,i,s){if(!(this instanceof k))return new k(t,e,n,r,o,i,s);var u=t,c=e,a=n,f=r,h=o,p=i,l=s;this.__defineGetter__("host",(function(){return u})),this.__defineGetter__("hive",(function(){return c})),this.__defineGetter__("key",(function(){return a})),this.__defineGetter__("name",(function(){return f})),this.__defineGetter__("type",(function(){return h})),this.__defineGetter__("value",(function(){return p})),this.__defineGetter__("arch",(function(){return l}))}function x(t){if(!(this instanceof x))return new x(t);var e=t||{},n=""+(e.host||""),r=""+(e.hive||s),o=""+(e.key||""),i=e.arch||null;if(this.__defineGetter__("host",(function(){return n})),this.__defineGetter__("hive",(function(){return r})),this.__defineGetter__("key",(function(){return o})),this.__defineGetter__("path",(function(){return(0==n.length?"":"\\\\"+n+"\\")+r+o})),this.__defineGetter__("arch",(function(){return i})),this.__defineGetter__("parent",(function(){var t=o.lastIndexOf("\\");return new x({host:this.host,hive:this.hive,key:-1==t?"":o.substring(0,t),arch:this.arch})})),-1==f.indexOf(r))throw new Error("illegal hive specified.");if(!w.test(o))throw new Error("illegal key specified.");if(i&&"x64"!=i&&"x86"!=i)throw new Error("illegal architecture specified (use x86 or x64)")}r.inherits(g,Error),r.inherits(k,Object),x.HKLM=s,x.HKCU=u,x.HKCR=c,x.HKU="HKU",x.HKCC=a,x.HIVES=f,x.REG_SZ=h,x.REG_MULTI_SZ=p,x.REG_EXPAND_SZ=l,x.REG_DWORD=_,x.REG_QWORD=d,x.REG_BINARY=E,x.REG_NONE=v,x.REG_TYPES=y,x.DEFAULT_VALUE="",x.prototype.values=function(t){if("function"!=typeof t)throw new TypeError("must specify a callback");var e=["QUERY",this.path];D(e,this.arch);var n=i(T(),e,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),r="",o=this,s=null,u=G(n);return n.on("close",(function(e){if(!s)if(0!==e)t(S("QUERY",e,u),null);else{for(var n=[],i=[],c=r.split("\n"),a=0,f=0,h=c.length;f<h;f++){var p=c[f].trim();p.length>0&&(0!=a&&n.push(p),++a)}for(f=0,h=n.length;f<h;f++){var l,_,d,E=m.exec(n[f]);E&&(l=E[1].trim(),_=E[2].trim(),d=E[3],i.push(new k(o.host,o.hive,o.key,l,_,d,o.arch)))}t(null,i)}})),n.stdout.on("data",(function(t){r+=t.toString()})),n.on("error",(function(e){s=e,t(e)})),this},x.prototype.keys=function(t){if("function"!=typeof t)throw new TypeError("must specify a callback");var e=["QUERY",this.path];D(e,this.arch);var n=i(T(),e,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),r="",o=this,s=null,u=G(n);return n.on("close",(function(e){s||0!==e&&t(S("QUERY",e,u),null)})),n.stdout.on("data",(function(t){r+=t.toString()})),n.stdout.on("end",(function(){for(var e=[],n=[],i=r.split("\n"),s=0,u=i.length;s<u;s++){var c=i[s].trim();c.length>0&&e.push(c)}for(s=0,u=e.length;s<u;s++){var a,f=R.exec(e[s]);f&&(f[1],(a=f[2])&&a!==o.key&&n.push(new x({host:o.host,hive:o.hive,key:a,arch:o.arch})))}t(null,n)})),n.on("error",(function(e){s=e,t(e)})),this},x.prototype.get=function(t,e){if("function"!=typeof e)throw new TypeError("must specify a callback");var n=["QUERY",this.path];""==t?n.push("/ve"):n=n.concat(["/v",t]),D(n,this.arch);var r=i(T(),n,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),o="",s=this,u=null,c=G(r);return r.on("close",(function(t){if(!u)if(0!==t)e(S("QUERY",t,c),null);else{for(var n=[],r=null,i=o.split("\n"),a=0,f=0,h=i.length;f<h;f++){var p=i[f].trim();p.length>0&&(0!=a&&n.push(p),++a)}var l,_,d,E=n[n.length-1]||"",v=m.exec(E);v&&(l=v[1].trim(),_=v[2].trim(),d=v[3],r=new k(s.host,s.hive,s.key,l,_,d,s.arch)),e(null,r)}})),r.stdout.on("data",(function(t){o+=t.toString()})),r.on("error",(function(t){u=t,e(t)})),this},x.prototype.set=function(t,e,n,r){if("function"!=typeof r)throw new TypeError("must specify a callback");if(-1==y.indexOf(e))throw Error("illegal type specified.");var o=["ADD",this.path];""==t?o.push("/ve"):o=o.concat(["/v",t]),D(o=o.concat(["/t",e,"/d",n,"/f"]),this.arch);var s=i(T(),o,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),u=null,c=G(s);return s.on("close",(function(t){u||r(0!==t?S("ADD",t,c):null)})),s.stdout.on("data",(function(t){})),s.on("error",(function(t){u=t,r(t)})),this},x.prototype.remove=function(t,e){if("function"!=typeof e)throw new TypeError("must specify a callback");var n=t?["DELETE",this.path,"/f","/v",t]:["DELETE",this.path,"/f","/ve"];D(n,this.arch);var r=i(T(),n,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),o=null,s=G(r);return r.on("close",(function(t){o||(0!==t?e(S("DELETE",t,s),null):e(null))})),r.stdout.on("data",(function(t){})),r.on("error",(function(t){o=t,e(t)})),this},x.prototype.clear=function(t){if("function"!=typeof t)throw new TypeError("must specify a callback");var e=["DELETE",this.path,"/f","/va"];D(e,this.arch);var n=i(T(),e,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),r=null,o=G(n);return n.on("close",(function(e){r||(0!==e?t(S("DELETE",e,o),null):t(null))})),n.stdout.on("data",(function(t){})),n.on("error",(function(e){r=e,t(e)})),this},x.prototype.erase=x.prototype.clear,x.prototype.destroy=function(t){if("function"!=typeof t)throw new TypeError("must specify a callback");var e=["DELETE",this.path,"/f"];D(e,this.arch);var n=i(T(),e,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),r=null,o=G(n);return n.on("close",(function(e){r||(0!==e?t(S("DELETE",e,o),null):t(null))})),n.stdout.on("data",(function(t){})),n.on("error",(function(e){r=e,t(e)})),this},x.prototype.create=function(t){if("function"!=typeof t)throw new TypeError("must specify a callback");var e=["ADD",this.path,"/f"];D(e,this.arch);var n=i(T(),e,{cwd:void 0,env:process.env,stdio:["ignore","pipe","pipe"]}),r=null,o=G(n);return n.on("close",(function(e){r||(0!==e?t(S("ADD",e,o),null):t(null))})),n.stdout.on("data",(function(t){})),n.on("error",(function(e){r=e,t(e)})),this},x.prototype.keyExists=function(t){return this.values((function(e,n){if(e)return 1==e.code?t(null,!1):t(e);t(null,!0)})),this},x.prototype.valueExists=function(t,e){return this.get(t,(function(t,n){if(t)return 1==t.code?e(null,!1):e(t);e(null,!0)})),this},t.exports=x},5335:(t,e,n)=>{"use strict";n.r(e),n.d(e,{findSession:()=>f,formatSession:()=>c,getCachedFinder:()=>p,getSession:()=>h,getSessions:()=>a});var r=n(2118),o=n(2809),i=n(2516);const s=new r({hive:r.HKCU,key:"\\Software\\SimonTatham\\PuTTY\\Sessions\\"}),u=["name","hostname","protocol","portnumber","username","usernamefromenvironment","tryagent","publickeyfile","proxyhost","proxyport","proxylocalhost","proxymethod"];function c(t){const e={};for(const n of u)e[n]=t[n];return JSON.stringify(e)}async function a(){o.zW.info`Fetching PuTTY sessions from registry`;const t=await(0,i.Vi)((t=>s.keys(t))),e=[];return await Promise.all(t.map((t=>(async()=>{const n=decodeURIComponent(t.key.substr(s.key.length)),r=await(0,i.Vi)((e=>t.values(e))),o={};r.forEach((t=>o[t.name.toLowerCase()]=function(t){switch(t.type){case"REG_DWORD":return parseInt(t.value,16);case"REG_SZ":return t.value}throw new Error(`Unknown RegistryItem type: '${t.type}'`)}(t))),e.push({name:n,...o})})()))),o.zW.debug`\tFound ${e.length} sessions:`,e.forEach((t=>o.zW.debug`\t- ${c(t)}`)),e}async function f(t,e,n,r,o=!0){if(e){e=e.toLowerCase();const n=t.find((t=>t.name.toLowerCase()===e));if(o||n)return n}if(!n)return;n=n.toLowerCase();const i=t.filter((t=>t.hostname&&t.hostname.toLowerCase()===n));return r?(r=r.toLowerCase(),i.find((t=>!t.username||t.username.toLowerCase()===r))):i[0]||null}async function h(t,e,n,r=!0){return f(await a(),t,e,n,r)}async function p(){const t=await a();return(...e)=>f(t,...e)}}};
//# sourceMappingURL=9230.extension.js.map